AWSTemplateFormatVersion: 2010-09-09
Description: 'zenpayroll-api

  Proxy service to ZenPayroll'
Transform:
- AWS::Serverless-2016-10-31
Globals:
  Function:
    Timeout: 15
Parameters:
  ENV:
    Type: String
    Default: development
    AllowedValues:
    - production
    - demo
    - development
Resources:
  createApplication:
    Type: AWS::Serverless::Function
    Properties:
      Handler: src/handlers/create-application.createApplicationHandler
      Runtime: nodejs12.x
      Description: Creates a developer application in ZenPayroll.
      Policies:
      - AWSSecretsManagerGetSecretValuePolicy:
          SecretArn: app/*/payroll/doorkeeper_api
      Environment:
        Variables:
          ENV:
            Ref: ENV
      Events:
        Api:
          Type: Api
          Properties:
            Path: /partners/{partnerId}/applications
            Method: POST
      CodeUri: createApplication
